模組: `DCT_with_Quantizer` 
---

### 1️⃣ Input（輸入）

| 名稱        | 類型    | 說明                            |
| --------- | ----- | ----------------------------- |
| `Clock`   | input | 系統時脈，用於驅動 FSM 和資料處理           |
| `reset`   | input | 高態時會將 state 和 enable2 重設為初始狀態 |
| `enable1` | input | 啟動處理流程的觸發訊號（高態時啟動）            |
|`inputdata`| input |8*8像素矩陣|


---

### 2️⃣ Output（輸出）

| 名稱               | 類型                  | 說明                              |
| ---------------- | ------------------- | ------------------------------- |
| `quantized_flat` | output reg \[511:0] | 8×8 量化後矩陣的扁平化輸出，共 64 個 8-bit 整數 |
| `enable2`        | output reg          | 當整個流程完成（state = 255）時拉高，表示輸出有效  |

---

### 3️⃣ Method（處理流程）

整個流程透過 FSM（狀態機）進行控制，並將整個 8×8 圖像塊進行以下步驟：

| state 範圍   | 階段    | 說明                                                           |
| ---------- | ----- | ------------------------------------------------------------ |
| 0 \~ 63    | 行 DCT | 對每一行進行 DCT（左乘 DCT 矩陣） → 存入 `temp1`，除以 10000 做 fixed-point 縮放 |
| 64 \~ 127  | 列 DCT | 對 `temp1` 做列方向 DCT（右乘 DCT^T）→ 存入 `result`，再除以 10000          |
| 128 \~ 191 | 量化    | 將 `result[i][j]` 除以 JPEG 量化表 Q\[i]\[j]，存入 `quantized`        |
| 192 \~ 255 | 扁平化輸出 | 將 `quantized` 扁平化後存入 `quantized_flat`（64×8bit）               |

---

### 4️⃣ Usecase（使用情境）

本模組適合應用於 **JPEG 編碼中的壓縮流程**，尤其是：

* 灰階圖像區塊 (8×8 pixel block) 的壓縮
* 固定輸入來源的簡化測試（像這裡用 `initial` 內建 pixel）
* 作為 SoC 或 FPGA JPEG pipeline 的子模組，例如：`RGB → YCbCr → DCT_with_Quantizer → Zigzag → RLE → Huffman`

也適合使用者：

* 在 FPGA 上驗證 DCT + 量化功能正確性
* 製作可合成的 JPEG 子系統模組（之後再串 AXI-Stream）

---

### 5️⃣ Attributes（模組特性）

| 特性              | 說明                                             |
| --------------- | ---------------------------------------------- |
| **資料大小**        | 處理 8×8 pixel，輸出 64 個 8-bit 量化值                 |
| **Fixed-Point** | 所有 DCT 運算皆使用固定小數點（DCT 係數 \*10000 再除回來）         |
| **FSM 控制**      | 以 `state` 作為控制器，確保一時鐘一操作，避免 for-loop（合成友善）     |
| **可合成性強**       | 無 `for`、無動態陣列，支援 RTL synthesis                 |
| **延遲時間固定**      | 共 256 個 state → 需 256 個 clock cycle 才完成整個流程    |
| **可擴展性**        | 可從固定 `pixel[][]` 改成輸入埠 + 緩衝機制以支援連續多塊處理（可改 AXI） |

---

