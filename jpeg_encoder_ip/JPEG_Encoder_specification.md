# JPEG Encoder IP Specification

## ğŸ“¥ Input

| åç¨±               | é¡å‹          | èªªæ˜ |
|--------------------|---------------|------|
| `s_axis_tdata`     | AXI4-Stream   | Y/Cb/Cr è³‡æ–™ï¼ˆé€šå¸¸ç‚º 8-bit æˆ– 16-bitï¼‰|
| `s_axis_tvalid`    | AXI4-Stream   | æœ‰æ•ˆè³‡æ–™æŒ‡ç¤º |
| `s_axis_tready`    | AXI4-Stream   | IP æº–å‚™æ¥æ”¶è³‡æ–™ |
| `s_axis_tlast`     | AXI4-Stream   | ä¸€å€‹å½±åƒçµæŸæŒ‡ç¤º |
| `aclk`             | Clock         | å…¨ç³»çµ±æ™‚è„ˆ |
| `aresetn`          | Active-Low Reset | é‡è¨­ä¿¡è™Ÿ |
| (å¯é¸) `config_*`  | æ§åˆ¶è¨Šè™Ÿï¼ˆAXI-Lite or input pinsï¼‰| è¨­å®šå“è³ªã€Q-tableã€image size ç­‰åƒæ•¸ |

---

## ğŸ“¤ Output

| åç¨±               | é¡å‹          | èªªæ˜ |
|--------------------|---------------|------|
| `m_axis_tdata`     | AXI4-Stream   | JPEG Bitstream å£“ç¸®è³‡æ–™ï¼ˆ8-bitï¼‰|
| `m_axis_tvalid`    | AXI4-Stream   | æœ‰æ•ˆè¼¸å‡ºè³‡æ–™æŒ‡ç¤º |
| `m_axis_tready`    | AXI4-Stream   | æ¥æ”¶è€…æº–å‚™å¥½æ¥è³‡æ–™ |
| `m_axis_tlast`     | AXI4-Stream   | ä¸€å¼µåœ–çš„ bitstream çµå°¾æŒ‡ç¤º |
| (å¯é¸) `output_length` | AXI-Lite å¯„å­˜å™¨ | JPEG Bitstream çš„ç¸½é•·åº¦ï¼ˆBytesï¼‰|

---

## âš™ï¸ Attributes

| å±¬æ€§         | èªªæ˜                                   |
|--------------|----------------------------------------|
| æ”¯æ´è§£æåº¦   | 1980x1024ï¼Œæˆ–æ–¼SDKäº‹å…ˆè¨­å®š   |
| è‰²å½©æ ¼å¼     | æ¥æ”¶ YCbCrï¼ˆ4:2:0ï¼‰             |
| MCU çµæ§‹     | æ¯ MCUï¼š4 å€‹ Y block + 1 Cb + 1 Cr     |
| å‚³è¼¸ä»‹é¢     | å®Œå…¨ AXI4-Stream ç›¸å®¹                  |

---

## ğŸ›  Parametersï¼ˆå¯é€é AXI-Lite è¨­å®šï¼‰

| åç¨±             | é è¨­å€¼     | èªªæ˜                           |
|------------------|------------|--------------------------------|
| `IMAGE_WIDTH`     | 128        | åœ–ç‰‡å¯¬åº¦ï¼ˆåƒç´ ï¼‰               |
| `IMAGE_HEIGHT`    | 128        | åœ–ç‰‡é«˜åº¦ï¼ˆåƒç´ ï¼‰               |
| `COLOR_SUBSAMPLE` | 4:2:0      | YCbCr å­å–æ¨£æ ¼å¼               |
| `QUALITY_FACTOR`  | 50         | å£“ç¸®å“è³ªåƒæ•¸ï¼ˆå½±éŸ¿ Q-tableï¼‰  |
| `DATA_WIDTH`      | 8          | `tdata` å¯¬åº¦ï¼ˆ8 or 16ï¼‰        |

---

## ğŸ§  Methodï¼ˆé‹ä½œæ–¹å¼ï¼‰

1. **æ¥æ”¶è³‡æ–™**  
   é€é AXI4-Stream æ¥æ”¶é€£çºŒçš„ YCbCr å€å¡Šè³‡æ–™

2. **DCTï¼ˆé›¢æ•£é¤˜å¼¦è½‰æ›ï¼‰**  
   å°æ¯å€‹ 8Ã—8 å€å¡Šé€²è¡Œ 2D DCT è½‰æ›ã€‚

3. **Quantizationï¼ˆé‡åŒ–ï¼‰**  
   ä½¿ç”¨ Q-table å° DCT çµæœé€²è¡Œé‡åŒ–ï¼ˆå£“ç¸®ï¼‰ã€‚

4. **Huffman Encodingï¼ˆå“ˆå¤«æ›¼ç·¨ç¢¼ï¼‰**  
   å°‡é‡åŒ–å¾Œçš„ä¿‚æ•¸è½‰æ›æˆè®Šé•· bitstreamï¼ˆJPEG Bitstreamï¼‰ã€‚

5. **è³‡æ–™è¼¸å‡º**  
   å£“ç¸®å¾Œè³‡æ–™ä»¥ AXI4-Stream æ ¼å¼è¼¸å‡ºï¼Œç›´åˆ° `tlast = 1` ç‚ºæ­¢ã€‚

---

## ğŸ“˜ å‚™è¨»

- è¼¸å‡ºçš„ bitstream å¯ç›´æ¥å¯«æˆ `.jpg` æª”ã€‚
- å¯èˆ‡ AXI DMA æ­é…ï¼Œé€é DMA å°‡è¼¸å‡ºå¯«å…¥ DDRã€‚
- è‹¥ä¸ç¢ºå®šè¼¸å‡ºé•·åº¦ï¼Œå¯æ ¹æ“š `tlast` åµæ¸¬çµæŸï¼Œæˆ–ä½¿ç”¨é™„åŠ  `output_length` è¨»å†Šã€‚

